# https://sujinnaljin.medium.com/ci-cd-github-actions-를-이용한-xcode-build-test-자동화-73b90a3dcc65
# https://sujinnaljin.medium.com/ci-cd-github-actions-를-이용한-testflight-업로드-자동화-8ecdbeb227a3
name: Run Test

on:
  push:
    branches: [ develop ]
  pull_request:
    branches: [ develop ]

jobs:
  build:
    runs-on: macos-latest

    steps:
      - uses: actions/checkout@v2

      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: "16.1.0"  

      - name: List Xcode Versions
        run: |
          echo "Current Xcode version:"
          xcodebuild -version
          echo "Installed Xcode versions in /Applications:"
          ls -1 /Applications | grep Xcode
      
      - name: List available simulators
        run: xcrun simctl list

      - name: Start xcode build 🛠
        run: |
          xcodebuild build \
            -project CICDTest.xcodeproj \
            -scheme CICDTest \
            -destination "platform=iOS Simulator,name=iPhone 15 Pro Max,OS=17.5"

      # - name: Start xcode build 🛠
      #   run: |
      #     xcodebuild clean test \
      #       -project CICDTest.xcodeproj \
      #       -scheme CICDTest \
      #       -destination "platform=iOS Simulator,name=iPhone 15 Pro Max,OS=17.5"
